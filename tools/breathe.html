<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>breathe</title>
    <style>
      :root { --lila:#F8CABA; --green:#B28622; }

      *,*::before,*::after{ box-sizing:border-box; }
      html,body{ height:100%; margin:0; }
      body{
        background:var(--lila);
        color:var(--green);
        font-family:"Inter",system-ui,sans-serif;
        font-weight:900; letter-spacing:.2px;
        overflow-x:hidden;
      }

      .app{
        display:flex; flex-direction:row; align-items:center; justify-content:center;
        gap:60px; max-width:100%; margin:40px auto; padding:20px;
      }

      .palette{ display:flex; flex-direction:column; gap:24px; align-items:flex-end; justify-content:center; }
      .pencil{ width:160px; height:28px; position:relative; cursor:pointer; transform:rotate(0deg); transition:transform .15s ease; }
      .pencil:hover{ transform:translateX(4px); }
      .pencil .shaft{ position:absolute; left:0; top:4px; width:110px; height:20px; background:var(--c); border-radius:8px; }
      .pencil .ring{ position:absolute; left:110px; top:6px; width:6px; height:16px; background:var(--green); }
      .pencil .wood{ position:absolute; left:116px; top:4px; width:22px; height:20px; background:#f0c49a; clip-path:polygon(0 0, 100% 50%, 0 100%); }
      .pencil .tip{ position:absolute; left:136px; top:11px; width:8px; height:6px; background:#1a1a1a; border-radius:1px; }
      .pencil.active .ring{ background:#fff; }

      .right-column{ flex:1; display:flex; flex-direction:column; align-items:center; }
      .topbar{ display:flex; align-items:center; justify-content:space-between; width:100%; max-width:700px; margin-bottom:12px; }
      .title{ font-size:clamp(18px,2.4vw,28px); text-transform:uppercase; }
      .controls{ display:flex; gap:16px; align-items:center; }
      .btn{ border:none; background:transparent; color:var(--green); text-decoration:underline; cursor:pointer; }
      .size{ display:flex; align-items:center; gap:10px; }
      .tiny{ font-size:12px; opacity:.9; }
      input[type=range]{ width:140px; accent-color:var(--green); }

      .stage{ position:relative; width:100%; max-width:700px; }
      .canvas-holder{ position:relative; width:100%; aspect-ratio:1280/900; background:#fff; overflow:hidden; border-radius:5px; }
      canvas{ position:absolute; inset:0; width:100%; height:100%; touch-action:none; }

      /* Chosen word display */
      .picked{
        text-align:center;
        font-weight:900;
        text-transform:uppercase;
        letter-spacing:.08em;
        margin-top:10px;
        font-size: clamp(16px, 2vw, 20px);
      }

      .mouse-wrap{ position:fixed; right:18px; bottom:18px; display:flex; align-items:flex-end; gap:12px; pointer-events:none; z-index:5; }
      .bubble{ max-width:min(65vw,360px); background:var(--green); color:var(--lila); font-weight:800; line-height:1.2; font-size:14px; padding:12px 14px; border-radius:12px; }
      .pmouse{ width:96px; height:96px; display:block; }

      /* Modal */
      .modal{ display:none; position:fixed; inset:0; align-items:center; justify-content:center; background:#F8CABA; z-index:1000; }
      .card{ width:min(94vw,760px); color:var(--green); padding:16px; }
      .bar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
      h2{ margin:0; font-size:clamp(18px,2.2vw,24px); text-transform:uppercase; }
      .new-btn{ border:none; background:transparent; color:var(--green); text-decoration:underline; cursor:pointer; }

      .choices{ display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:12px; }
      .choice{
        padding:14px 8px; cursor:pointer; text-align:center;
        display:flex; flex-direction:column; align-items:center;
        border:2px solid var(--green); border-radius:10px;
        transition: transform .12s ease;
      }
      .choice:hover{ transform:translateY(-1px); }
      .choice .label{ font-weight:800; text-transform:uppercase; letter-spacing:.4px; font-size:14px; color:var(--green); }

      @media (max-width:720px){
        .app{ flex-direction:column; align-items:center; }
        .palette{ flex-direction:row; gap:10px; }
      }
    </style>
  </head>
  <body>
    <div class="app">
      <div class="palette" id="palette"></div>

      <div class="right-column">
        <div class="topbar">
          <div class="title">breathe</div>
          <div class="controls">
            <div class="size">
              <span class="tiny">brush</span>
              <input id="size" type="range" min="2" max="24" value="6">
            </div>
            <button class="btn" id="newPaint">new word</button>
            <button class="btn" id="clear">clear</button>
            <button class="btn" id="export">export png</button>
          </div>
        </div>

        <div class="stage">
          <div class="canvas-holder">
            <canvas id="c" width="1080" height="900"></canvas>
          </div>
          <div class="picked" id="pickedLabel" aria-live="polite"></div>
        </div>
      </div>
    </div>

    <div class="mouse-wrap">
      <div class="bubble" id="bubble">pick something to draw!</div>
      <svg class="pmouse" viewBox="0 0 100 100">
        <path d="M50 8 L60 33 Q61 36 64 36 L91 36 Q94 36 91 39 L69 54 Q67 56 68 59
             L77 85 Q78 88 75 86 L50 70 Q50 69 49 70 L25 86 Q22 88 23 85
             L32 59 Q33 56 31 54 L9 39 Q6 36 9 36 L36 36 Q39 36 40 33 Z"
          fill="none" stroke="#B28622" stroke-width="3.2" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="43" cy="50" r="1.6" fill="#B28622"/>
        <circle cx="57" cy="50" r="1.6" fill="#B28622"/>
        <path d="M43 56 Q50 60 57 56" stroke="#B28622" stroke-width="2" stroke-linecap="round" fill="none"/>
      </svg>
    </div>

    <div class="modal" id="modal">
      <div class="card">
        <div class="bar">
          <h2>what should we draw today?</h2>
          <button class="new-btn" id="reshuffle" type="button">shuffle ideas</button>
        </div>
        <div class="choices" id="choices"></div>
      </div>
    </div>

    <script>
(() => {
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');
  const palette = document.getElementById('palette');
  const sizeEl = document.getElementById('size');
  const modal = document.getElementById('modal');
  const choicesWrap = document.getElementById('choices');
  const bubble = document.getElementById('bubble');
  const pickedLabel = document.getElementById('pickedLabel');

  const COLORS = ['#1a1a1a','#e63946','#ff8fab','#ffb703','#8ac926','#00bcd4','#7b5cff','#e07be0'];
  const OBJECT_POOL = [
    { key:'bunny',label:'Bunny' },
    { key:'kitten',label:'Kitten' },
    { key:'panda',label:'Panda' },
    { key:'unicorn',label:'Unicorn' },
    { key:'butterfly',label:'Butterfly' },
    { key:'strawberry',label:'Strawberry' },
    { key:'sunflower',label:'Sunflower' },
    { key:'cloud',label:'Cloud' },
    { key:'rainbow',label:'Rainbow'},
    { key:'cupcake',label:'Cupcake'},
    { key:'penguin',label:'Penguin'},
    { key:'duck',label:'Duck'},
    { key:'star',label:'Star'},
    { key:'koala',label:'Koala' }
  ];

  const FEEDBACK = {
    default:[
      "That {name} energy is âœ¨immaculateâœ¨",
      "Certified {name}! Keep going ðŸ’–",
      "Obsessed with this {name}. Big art vibes",
      "Cuuute {name}!!!",
      "Your {name} is serving pure magic",
      "You're a born artist!",
      "I see where you're going..Keep up the good work!",
      "Slay","O M G","Smart thinking!",
      "Could that {name} be any cooler?",
      "I'm so honoured to see you paint",
      "May I have your autograpgh?!",
      "Dayummm",
      "This is the best {name} I've ever seen",
      "Never stop please, you're doing gods work!",
      "Uhhh good Idea",
      "What a precice stroke",
      "Nice color you picked there:)",
      "Don't forget me when you're famous",
      "Such a masterpiece"
    ],
    bunny:["Those {name} ears? âœ¨fluffyyy!âœ¨"],
    kitten:["Purrfect whiskers!","That tiny noseâ€¦ I canâ€™t!"],
    star:["Shine on! â­","Wish granted â€” what a magical {name}! ðŸ’–"],
    panda:["The only thing missing is some yummy bamboo"],
    unicorn:["Wow, I love that color combo! Magical"],
    butterfly:["Fly, fly, fly up in the sky"],
    strawberry:["Yummmm, I just love summer"],
    sunflower:["The sun shines for you â€“ and that sunflower"],
    cloud:["cutee, you make gloomy weather look cozy! ðŸ’–"],
    rainbow:["Don't we just love peace and love for all?"],
    cupcake:["There's never too much frosting"],
    penguin:["How do such cute animals survive ice cold weather? Brrr"],
    duck:["Quack, quack, look at the cutie go"]
  };

  let chosen=null,drawing=false,last=null,color=COLORS[0];
  let brush=parseInt(sizeEl.value,10)||6;

  function paintWhite(){ctx.fillStyle='#fff';ctx.fillRect(0,0,canvas.width,canvas.height);}
  function toXY(e){const r=canvas.getBoundingClientRect();const x=(e.touches?e.touches[0].clientX:e.clientX)-r.left;const y=(e.touches?e.touches[0].clientY:e.clientY)-r.top;return{x:x*(canvas.width/r.width),y:y*(canvas.height/r.height)};}
  function line(a,b){ctx.beginPath();ctx.moveTo(a.x,a.y);ctx.lineTo(b.x,b.y);ctx.lineCap='round';ctx.lineJoin='round';ctx.strokeStyle=color;ctx.lineWidth=brush;ctx.stroke();}
  function sampleN(a,n){return a.slice().sort(()=>Math.random()-0.5).slice(0,n);}
  function showMouseMessage(t){bubble.innerHTML=t;}
  function setPickedLabel(text){ pickedLabel.textContent = text || ""; }

  function feedbackAfterStroke(){
    if(!chosen)return;
    const b=(FEEDBACK[chosen.key]||[]).concat(FEEDBACK.default);
    const msg=b[Math.floor(Math.random()*b.length)].replaceAll('{name}',chosen.label.toLowerCase());
    showMouseMessage(msg);
  }

  paintWhite();

  function startDraw(e){if(!chosen){openChooser();return;}drawing=true;last=toXY(e);ctx.fillStyle=color;ctx.beginPath();ctx.arc(last.x,last.y,brush/2,0,Math.PI*2);ctx.fill();e.preventDefault();}
  function moveDraw(e){if(!drawing)return;const p=toXY(e);line(last,p);last=p;e.preventDefault();}
  function endDraw(){if(!drawing)return;drawing=false;feedbackAfterStroke();}

  canvas.addEventListener('mousedown',startDraw);
  canvas.addEventListener('mousemove',moveDraw);
  window.addEventListener('mouseup',endDraw);
  canvas.addEventListener('touchstart',startDraw,{passive:false});
  canvas.addEventListener('touchmove',moveDraw,{passive:false});
  canvas.addEventListener('touchend',endDraw,{passive:false});

  function buildPalette(){
    palette.innerHTML='';
    COLORS.forEach(c=>{
      const el=document.createElement('button');
      el.className='pencil';
      el.style.setProperty('--c',c);
      el.setAttribute('aria-label', `color ${c}`);
      el.innerHTML='<div class="shaft"></div><div class="ring"></div><div class="wood"></div><div class="tip"></div>';
      el.onclick=()=>{document.querySelectorAll('.pencil').forEach(p=>p.classList.remove('active'));el.classList.add('active');color=c;};
      palette.appendChild(el);
    });
    if (palette.firstChild) palette.firstChild.classList.add('active');
  }
  buildPalette();

  sizeEl.oninput=e=>brush=parseInt(e.target.value)||6;
  document.getElementById('clear').onclick=()=>{ctx.clearRect(0,0,canvas.width,canvas.height);paintWhite();};
  document.getElementById('export').onclick=()=>{const link=document.createElement('a');link.download='breathe.png';link.href=canvas.toDataURL('image/png');link.click();};
  document.getElementById('newPaint').onclick=()=>{
    openChooser();
    ctx.clearRect(0,0,canvas.width,canvas.height); paintWhite();
    setPickedLabel("");
  };

  function renderChoices(){
    choicesWrap.innerHTML='';
    const picks=sampleN(OBJECT_POOL,3);
    picks.forEach(o=>{
      const d=document.createElement('div');
      d.className='choice';
      d.innerHTML = `<div class="label">${o.label}</div>`;
      d.onclick=()=>{
        chosen=o;
        modal.style.display='none';
        setPickedLabel(o.label);
        showMouseMessage(`You picked ${o.label} â€” start drawing âœ¨`);
      };
      choicesWrap.appendChild(d);
    });
  }

  function openChooser(){
    renderChoices();
    modal.style.display='flex';
  }

  document.getElementById('reshuffle').onclick=renderChoices;
  // Open on load
  openChooser();
  showMouseMessage('pick something to draw!');
})();
    </script>
  </body>
</html>
